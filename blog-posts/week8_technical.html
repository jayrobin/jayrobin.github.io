<!DOCTYPE html>
<html>
	<head>
		<title>Jayrobin @ DBC</title>
		<meta charset='utf-8'>
		<link rel="shortcut icon" href="../images/favicon.ico">
		<link rel='stylesheet' href='../blog-posts/stylesheets/reset.css'>
		<link rel='stylesheet' href='../blog-posts/stylesheets/blog.css'>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-2202293-16', 'jayrobin.github.io');
      ga('send', 'pageview');

    </script>
	</head>
	<body ontouchstart>
		<header>
			<h1>JAYROBIN</h1>
			<nav>
				<ul>
					<li id='home'><a href='../index.html'>Home</a></li>
					<li id='about'><a href='../about.html'>About</a></li>
					<li id='github'><a href='http://www.github.com/jayrobin'>GitHub</a></li>
					<li id='contact'><a href='mailto:james.michael.robinson@gmail.com'>Contact</a></li>
				</ul>
			</nav>
			<h2>Or: how I learned to stop worrying and love programming</h2>
		</header>
		<main>
			<section>
				<article>
					<h3>Week Eight - Technical blog</h3>
					<span class="article_content">
						<p class='date'>24 Jul 2014</p>
						<h4>What are regular expressions?</h4>
						<p>Regular Expressions (or regex/regexp) is a way of describing a pattern to search through strings. Rather than simply finding a given word in a string, they allow you to find, retrieve and replace very complex patterns. Take for example the text below:</p>

						<span class='code'>
							<span>Welcome to my super awesome website, my name is Bob Smith and you can call me on (555) 123-123. Thanks for visiting!</span>
						</span>

						<p>If we wanted to programmatically search this text to see if it contained a phone number using a basic search function with a static string it would be next to impossible without knowing the exact phone number and format first. However, with regular expressions, we can describe the pattern of a phone number without needing to know the digits, and the regular expression will search the string to see if that pattern is matched anywhere in the string.</p>

						<img src='http://imgs.xkcd.com/comics/regular_expressions.png' alt='xkcd - regular expressions' class='center' />
						<h4>How do I use regular expressions?</h4>
						<p>Regexes are quite difficult for beginners, since they require knowledge of the various symbols that are used to describe the pattern. However, even knowing a few basic ones is enough to get started.</p>

						<p>In ruby, like everything else, regular expressions are objects (they're actually an instance of the 'Regexp' class). Similar to how strings are instantiated with a literal syntax using double quotes (e.g. "hello, world"), regexes are instantiated with forward slashes: /some regex/</p>

						<p>Once you have a regex in ruby, you can use it in a number of ways...</p>

						<h4>Using regexes to search for text</h4>
						<p>Given a block of text, you might want to see if it contains a particular pattern, such as a URL. Since URLs can start with either http or https, we can construct a basic regex using an 'OR':</p>

						<span class='code'>
							<span># a|b (matches either a or b)</span>
							<span>/http:|https:/</span>
						</span>

						<p>We can then use this regex to test against a block of text using '=~', which returns the index of the first instance of the pattern, if the pattern is matched in the string, or nil if not:</p>

						<span class='code'>
							<span>my_string =~ /http:|https:/</span>
						</span>

						<h4>Using regular expressions to extract text</h4>
						<p>What if we had a block of text and wanted to extract data from it? For example, if we had a selection of job applications, we might want to obtain all of the applicants phone numbers - this could be a very time consuming process if done manually. With regexes, we can describe the pattern of a phone number using a few basic symbols.</p>

						<p>First, with regexes we can define a group of possible matching character, so [abc] would match either the letter a, b or c. To match any digit, we could do [0123456789], but this can also be written [0-9] (similarly, for letters we can use [a-z] and [A-Z], or even [a-zA-Z] to match any upper or lower case letter).</p>

						<p>Matching parentheses is a little more tricky, since they're actually sometimes used in regular expressions. If we want to actually match a parenthesis, we have to escape it with a backslash: \( and \) (this is similar to how escape characters are used in strings, e.g. "this is a double quote: \" that was a double quote")</p>

						<p>If we know that the phone numbers will have an open parenthesis, followed by three digits, a close parenthesis, a space, three more digits, a dash and finally four more digits, we could describe the pattern like so:</p>

						<span class='code'>
							<span>/\([0-9][0-9][0-9]\) [0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]/</span>
						</span>

						<p>However, digits can be also matched in regexes using '\d' - this will match any single number from 0 to 9:</p>

						<span class='code'>
							<span>/\(\d\d\d\) \d\d\d-\d\d\d\d/</span>
						</span>

						<p>The above regex can be further, since regexes allow us to also describe how many times the previous symbol should be repeated by adding the number of repeats in curly brackets directly after the symbol. For example, \d{3} would match any three digits in a row: 123, 987, 555, 010, and so on.</p>

						<span class='code'>
							<span>/\(\d{3}\) \d{3}-\d{4}/</span>
						</span>

						<p>With this regex, we can use String#scan, which will return an array of all matches:</p>

						<span class='code'>
							<span>my_string.scan(/\(\d{3}\) \d{3}-\d{4}/)</span>
							<span># returns ["(555) 555-5555"]</span>
						</span>

						<h4>Using regular expressions to replace text</h4>
						<p>Using the prior example of job applications, what if we wanted to redact confidential details such as phone number before sending them on to someone else? We already have the necessary regular expression to match the phone number, so we can just use String#gsub (global substitution) to replace them:</p>

						<span class='code'>
							<span># the first parameter is the regex</span>
							<span># the second is the string to replace the match with</span>
							<span>my_string.gsub(/\(\d{3}\) \d{3}-\d{4}/, "REDACTED")</span>
						</span>

						<p>Now let's say that some of the applicants have just entered a local number with no area code (e.g. 123-4567), we obviously still want to match the area code where provided, but we also want to match numbers where it isn't provided. In a regex '?' can be used to describe a symbol as being optional, for example 'ab?c' means "a followed by an optional b followed by c", which would match both 'abc' and 'ac'. We could have each part of the area code be optional, like so:</p>

						<span class='code'>
							<span>/\(?\d{3}?\)? ?\d{3}-\d{4}/</span>
						</span>

						<p>The above regex describes "an optional open parenthesis, three optional digits, an optional closed parenthesis, an optional space", but it would be much cleaner to describe the whole area code as optional by wrapping it in parentheses, like so:</p>

						<span class='code'>
							<span>/(\(\d{3}\) )?\d{3}-\d{4}/</span>
						</span>
						
						<p>We can also use String#gsub with a block to dynamically <em>alter</em> a match rather than just replacing it. For example, if we wanted to replace weights in pounds in a block of text with the corresponding weight in kilograms, we would want to match one or more digits ('+' in regexes describes 'one or more'), followed by a space, followed by 'lbs'. We might use a regex like the following:</p>

						<span class='code'>
							<span>my_string = "Weights: 50 lbs, 100 lbs, 250 lbs"</span>
							<span>my_string.gsub(/\d+ lbs/) { |weight| (weight.to_f / 2.2).round.to_s +  " kg"  }</span>
							<span># returns "Weights: 23 kg, 45 kg, 114 kg"</span>
						</span>

						<p>There are obviously a huge number of additional symbols that can be used to describe patterns using regular expressions, which I go into in more detail in my <a href='../unit3_cheatsheet.html'>Regex Cheatsheet</a>.</p>
					</span>
				</article>
			</section>
		</main>
		<footer>
			<nav>
				<ul>
					<li>
						<a href='https://www.facebook.com/jamesmichaelrobinson'>
							<span aria-hidden="true" data-icon="&#xe602;"></span>
							<span class="screen-reader">Facebook</span>
						</a>
					</li>
					<li>
						<a href='https://plus.google.com/u/0/112484955141279120302/'>
							<span aria-hidden="true" data-icon="&#xe601;"></span>
							<span class="screen-reader">Google+</span>
						</a>
					</li>
					<li>
						<a href='https://twitter.com/jayrob_in'>
							<span aria-hidden="true" data-icon="&#xe603;"></span>
							<span class="screen-reader">Twitter</span>
						</a>
					</li>
					<li>
						<a href='http://www.github.com/jayrobin'>
							<span aria-hidden="true" data-icon="&#xe604;"></span>
							<span class="screen-reader">GitHub</span>
						</a>
					</li>
					<li>
						<a href='http://uk.linkedin.com/in/jayrobin'>
							<span aria-hidden="true" data-icon="&#xe605;"></span>
							<span class="screen-reader">LinkedIn</span>
						</a>
					</li>
					<li>
						<a href='mailto:james.michael.robinson@gmail.com'>
							<span aria-hidden="true" data-icon="&#xe600;"></span>
							<span class="screen-reader">Email</span>
						</a>
					</li>
				</ul>
			</nav>
		</footer>
	</body>
</html>